---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import Navigation from "../../components/Navigation.astro";
import Footer from "../../components/Footer.astro";
import BullshitDetector from "../../components/BullshitDetector.astro";

export async function getStaticPaths() {
  const posts = await getCollection("articoli");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await post.render();
---

<Layout title={post.data.title} description={post.data.description}>
  <Navigation />

  <div class="min-h-screen bg-slate-50">
    <article
      class="w-full max-w-4xl mx-auto px-4 py-12 md:py-20 text-slate-900"
    >
      <!-- Header -->
      <header class="mb-12 text-center border-b border-slate-200 pb-12">
        <div class="flex justify-center items-center gap-4 mb-6">
          <span
            class="px-3 py-1 bg-blue-50 text-blue-700 text-xs font-bold uppercase rounded-full tracking-wide"
          >
            {post.data.category}
          </span>
          <span class="text-slate-500 text-sm font-medium">
            {
              post.data.date.toLocaleDateString("it-IT", {
                year: "numeric",
                month: "long",
                day: "numeric",
              })
            }
          </span>
        </div>

        <h1
          class="font-bold text-4xl md:text-5xl lg:text-6xl mb-8 leading-tight tracking-tight text-slate-900"
        >
          {post.data.title}
        </h1>

        <p
          class="text-xl md:text-2xl text-slate-600 leading-relaxed font-medium max-w-2xl mx-auto"
        >
          {post.data.description}
        </p>

        {
          post.data.bsLevel > 0 && (
            <div class="mt-8 flex justify-center">
              <BullshitDetector
                level={post.data.bsLevel}
                label="Livello Fuffa"
              />
            </div>
          )
        }
      </header>

      <!-- Prose Content -->
      <div
        class="prose prose-lg prose-slate max-w-none prose-headings:font-bold prose-headings:text-slate-900 prose-p:leading-relaxed prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline prose-img:rounded-xl prose-img:shadow-sm"
      >
        <Content />
      </div>

      <!-- Author Box -->
      <div
        class="mt-16 bg-white border border-slate-200 p-8 rounded-xl shadow-sm flex flex-col md:flex-row gap-6 items-center md:items-start text-center md:text-left transition-all hover:shadow-md"
      >
        <div
          class="w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center text-2xl"
        >
          üë®‚Äçüíª
        </div>
        <div>
          <p
            class="text-xs font-bold uppercase text-slate-400 mb-1 tracking-wider"
          >
            Scritto da
          </p>
          <h3 class="font-bold text-xl text-slate-900 mb-2">
            Rocco Andrea Ligorio
          </h3>
          <p class="text-slate-600 mb-4 leading-relaxed">
            Divulgazione informatica dal mondo reale. Scrivo di tecnologia
            quando smette di funzionare e inizia a rompere le scatole.
          </p>
          <a
            href="/chi-sono"
            class="text-sm font-bold text-blue-600 hover:text-blue-800 uppercase tracking-wide"
            >Vedi Profilo ‚Üí</a
          >
        </div>
      </div>
    </article>

    <Footer />
  </div>
</Layout>
